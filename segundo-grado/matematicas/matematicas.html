<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Ejercicios de Matem√°ticas - 2¬∞ Grado</title>
  <link rel="stylesheet" href="style.css" />
</head>
<body>

  <h1>Ejercicios de Matem√°ticas</h1>

  <div class="box-opciones">
    <label><input type="checkbox" id="suma" /> Suma</label>
    <label><input type="checkbox" id="resta" /> Resta</label>
    <label><input type="checkbox" id="multiplicacion" /> Multiplicaci√≥n</label><br /><br />

    <label for="cantidad">Cantidad de ejercicios (10 a 50):</label>
    <input type="number" id="cantidad" min="10" max="50" value="10" /><br /><br />

    <button onclick="generarEjercicios()">Generar Ejercicios</button>
  </div>

  <div id="container"></div>

  <button id="botonCalificar" onclick="calificar()">Calificar</button>
  <button id="botonReiniciar" onclick="reiniciarTodo()">üîÑ Reiniciar</button>

  <div id="resultado"></div>

  <script>
    let ejerciciosGenerados = [];

    function generarNumero(digitos) {
      return digitos === 2
        ? Math.floor(Math.random() * 90) + 10
        : Math.floor(Math.random() * 9) + 1;
    }

    function generarEjercicios() {
      const tipos = [];
      if (document.getElementById("suma").checked) tipos.push("+");
      if (document.getElementById("resta").checked) tipos.push("‚àí");
      if (document.getElementById("multiplicacion").checked) tipos.push("√ó");

      const cantidad = parseInt(document.getElementById("cantidad").value);
      if (tipos.length === 0) {
        alert("Selecciona al menos un tipo de operaci√≥n.");
        return;
      }
      if (isNaN(cantidad) || cantidad < 10 || cantidad > 50) {
        alert("Ingresa una cantidad v√°lida entre 10 y 50.");
        return;
      }

      const contenedor = document.getElementById("container");
      const resultado = document.getElementById("resultado");
      contenedor.innerHTML = "";
      resultado.innerHTML = "";
      ejerciciosGenerados = [];

      for (let i = 0; i < cantidad; i++) {
        const num1 = generarNumero(2);
        const num2 = generarNumero(1);
        const op = tipos[Math.floor(Math.random() * tipos.length)];
        let resultadoCorrecto;

        switch (op) {
          case "+":
            resultadoCorrecto = num1 + num2;
            break;
          case "‚àí":
            resultadoCorrecto = num1 - num2;
            break;
          case "√ó":
            resultadoCorrecto = num1 * num2;
            break;
        }

        ejerciciosGenerados.push(resultadoCorrecto);

        const ejercicio = document.createElement("div");
        ejercicio.className = "exercise";
        ejercicio.innerHTML = `
          <div class="operacion">
            <div><span class="simbolo">&nbsp;</span>${num1}</div>
            <div><span class="simbolo">${op}</span>${num2}</div>
          </div>
          <input type="number" class="respuesta" />
        `;
        contenedor.appendChild(ejercicio);
      }
    }

    function calificar() {
  const inputs = document.querySelectorAll(".exercise input");
  const operaciones = document.querySelectorAll(".exercise .operacion");
  let correctas = 0;
  let errores = [];

  inputs.forEach((input, index) => {
    const respuesta = parseInt(input.value);
    const correcto = ejerciciosGenerados[index];

    const textoOperacion = operaciones[index].innerText
      .replace(/\n/g, " ")
      .replace(/\s+/g, " ")
      .trim(); // ejemplo: "24 + 3"

    if (respuesta === correcto) {
      correctas++;
      input.style.borderColor = "green";
    } else {
      input.style.borderColor = "red";
      errores.push(
        `‚ùå <strong>Ejercicio ${index + 1}</strong>: <code>${textoOperacion} = ?</code><br />
         Tu respuesta: <strong>${isNaN(respuesta) ? 'vac√≠a' : respuesta}</strong> ‚Äì Correcta: <strong>${correcto}</strong>`
      );
    }
  });

  const calificacion = (correctas / ejerciciosGenerados.length) * 10;
  let mensaje = `
    Respuestas correctas: ${correctas}/${ejerciciosGenerados.length}<br />
    Calificaci√≥n: ${calificacion.toFixed(1)} / 10
  `;

  if (calificacion === 10) {
    mensaje += `<div class="mensaje-final oro">ü•á ¬°Medalla de Oro!</div>`;
  } else if (calificacion >= 9) {
    mensaje += `<div class="mensaje-final plata">ü•à ¬°Medalla de Plata!</div>`;
  } else if (calificacion >= 8) {
    mensaje += `<div class="mensaje-final bronce">ü•â ¬°Medalla de Bronce!</div>`;
  } else {
    mensaje += `<div class="mensaje-final intentalo">üí™ Vuelve a intentarlo, ¬°t√∫ puedes!</div>`;
  }

  if (errores.length > 0) {
    mensaje += `<div style="margin-top: 15px; text-align: left;"><strong>Errores:</strong><ul>`;
    errores.forEach(e => mensaje += `<li style="margin-bottom: 8px;">${e}</li>`);
    mensaje += `</ul></div>`;
  }

  document.getElementById("resultado").innerHTML = mensaje;
}

    function reiniciarTodo() {
      document.getElementById("suma").checked = false;
      document.getElementById("resta").checked = false;
      document.getElementById("multiplicacion").checked = false;
      document.getElementById("cantidad").value = 10;
      document.getElementById("container").innerHTML = "";
      document.getElementById("resultado").innerHTML = "";
      ejerciciosGenerados = [];
      window.scrollTo(0, 0);
    }
  </script>
<div style="text-align: center; margin-top: 30px;">
  <a href="../../index.html" id="botonMenu">‚¨ÖÔ∏è Regresar a Men√∫ Principal</a>
</div>
</body>
</html>