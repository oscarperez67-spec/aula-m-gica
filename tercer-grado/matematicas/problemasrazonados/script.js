const problems = [
    {
    "pregunta": "Juanita ten칤a 250 manzanas. Compr칩 150 m치s y dio 120 a su hermana. 쮺u치ntas manzanas le quedan?",
    "opciones": ["260", "270", "280", "300"],
    "respuesta": "280"
  },
  {
    "pregunta": "Carlos ten칤a 500 chocolates. Comi칩 100 y luego compr칩 200 m치s. 쮺u치ntos chocolates tiene ahora?",
    "opciones": ["500", "450", "550", "600"],
    "respuesta": "600"
  },
  {
    "pregunta": "Marta ten칤a 300 boletos para el cine. Vendi칩 120 y luego compr칩 50 m치s. 쮺u치ntos boletos tiene ahora?",
    "opciones": ["200", "220", "230", "240"],
    "respuesta": "230"
  },
  {
    "pregunta": "Si un libro tiene 400 p치ginas y ya le칤ste 100, 쯖u치ntas p치ginas te faltan si lees 50 diarias durante 3 d칤as?",
    "opciones": ["150", "160", "170", "180"],
    "respuesta": "150"
  },
  {
    "pregunta": "Un grupo de estudiantes tiene 60 alumnos. 20 se fueron y luego llegaron 10 m치s. 쮺u치ntos estudiantes hay ahora?",
    "opciones": ["40", "45", "50", "55"],
    "respuesta": "50"
  },
  {
    "pregunta": "Mar칤a ten칤a 250 naranjas. Compr칩 100 m치s y le dio 50 a su amiga. 쮺u치ntas naranjas le quedan?",
    "opciones": ["240", "280", "300", "350"],
    "respuesta": "300"
  },
  {
    "pregunta": "Si tienes 400 pesos, compras una barra de chocolate por 100 pesos y una bebida por 50 pesos, 쯖u치nto dinero te queda?",
    "opciones": ["150", "200", "220", "250"],
    "respuesta": "250"
  },
  {
    "pregunta": "Si un paquete contiene 100 cartas y un ni침o compra 4 paquetes, pero pierde 10 cartas, 쯖u치ntas cartas tiene ahora?",
    "opciones": ["370", "380", "390", "400"],
    "respuesta": "390"
  },
  {
    "pregunta": "En una tienda hay 200 camisetas. Se vendieron 50 y luego llegaron 30 m치s. 쮺u치ntas camisetas hay ahora en la tienda?",
    "opciones": ["180", "190", "200", "220"],
    "respuesta": "180"
  },
  {
    "pregunta": "En una granja hay 300 vacas. Si venden 100 vacas y luego nacen 20 terneros, 쯖u치ntas vacas hay en total ahora?",
    "opciones": ["210", "220", "230", "230"],
    "respuesta": "220"
  },
  {
    "pregunta": "Un hombre ten칤a 200 monedas. Compr칩 50 boletos para un sorteo y luego gast칩 30 monedas m치s en una tienda. 쮺u치ntas monedas le quedan?",
    "opciones": ["120", "140", "130", "100"],
    "respuesta": "120"
  },
  {
    "pregunta": "Si un supermercado tiene 500 manzanas y vende 150, luego compra 100 m치s, 쯖u치ntas manzanas tiene ahora?",
    "opciones": ["450", "500", "600", "550"],
    "respuesta": "450"
  },
  {
    "pregunta": "En un torneo, Juan gan칩 30 puntos en la primera ronda y 20 en la segunda. Luego perdi칩 10 puntos. 쮺u치ntos puntos tiene ahora?",
    "opciones": ["35", "40", "45", "50"],
    "respuesta": "40"
  },
  {
    "pregunta": "Una tienda vendi칩 100 camisetas en la ma침ana y 80 en la tarde. Si en total ten칤a 300 camisetas 쯖u치ntas camisetas le quedan?",
    "opciones": ["130", "100", "90", "120"],
    "respuesta": "120"
  },
  {
    "pregunta": "Si en un jard칤n hay 500 flores y se plantan 200 m치s, pero 50 se marchitaron, 쯖u치ntas flores quedan?",
    "opciones": ["500", "550", "600", "650"],
    "respuesta": "650"
  },
  {
    "pregunta": "Si en una caja hay 300 pelotas, 120 son rojas y el resto son azules, 쯖u치ntas pelotas azules hay en la caja?",
    "opciones": ["180", "200", "220", "250"],
    "respuesta": "180"
  },
  {
    "pregunta": "Pedro ten칤a 150 monedas. Si gast칩 50 en un juego y luego ahorr칩 30, 쯖u치nto dinero tiene ahora?",
    "opciones": ["100", "110", "120", "130"],
    "respuesta": "130"
  },
  {
    "pregunta": "Mar칤a ten칤a 200 boletos para una rifa. Vendi칩 70 y luego compr칩 30 m치s. 쮺u치ntos boletos tiene ahora?",
    "opciones": ["150", "160", "170", "180"],
    "respuesta": "160"
  },
  {
    "pregunta": "Un cami칩n ten칤a 100 paquetes. Si descargaron 40 y luego llegaron 20 m치s, 쯖u치ntos paquetes hay en el cami칩n?",
    "opciones": ["60", "70", "75", "80"],
    "respuesta": "80"
  },
  {
    "pregunta": "Un grupo de 150 ni침os fue al parque. 50 de ellos se fueron antes de la hora y luego llegaron 20 m치s. 쮺u치ntos ni침os quedaron en el parque?",
    "opciones": ["100", "110", "130", "120"],
    "respuesta": "120"
  },
  {
    "pregunta": "En una tienda de ropa hab칤a 250 prendas. Se vendieron 80 y luego llegaron 30 m치s. 쮺u치ntas prendas hay ahora en la tienda?",
    "opciones": ["180", "190", "200", "210"],
    "respuesta": "200"
  },
  {
    "pregunta": "Un grupo de 500 personas viaj칩 en un autob칰s. 150 se bajaron en la primera parada y luego 50 m치s se bajaron en la siguiente. 쮺u치ntas personas quedan en el autob칰s?",
    "opciones": ["400", "300", "350", "250"],
    "respuesta": "300"
  },
  {
    "pregunta": "Si una granja tiene 200 gallinas y compran 50 m치s, pero 30 de ellas se escapan, 쯖u치ntas gallinas quedan?",
    "opciones": ["200", "230", "220", "250"],
    "respuesta": "220"
  },
  {
    "pregunta": "Si tienes 1000 pesos y compras un art칤culo que cuesta 400 y otro que cuesta 250, 쯖u치nto dinero te queda?",
    "opciones": ["250", "400", "300", "350"],
    "respuesta": "350"
  },
  {
    "pregunta": "En una f치brica de juguetes, se produjeron 600 juguetes. Se vendieron 200, pero luego llegaron 50 m치s. 쮺u치ntos juguetes hay ahora en la f치brica?",
    "opciones": ["450", "400", "500", "550"],
    "respuesta": "450"
  },
{
    "pregunta": "En una caja hay 400 bolas rojas. Compraron 200 m치s y regalaron 100. 쮺u치ntas bolas rojas hay ahora?",
    "opciones": ["600", "500", "400", "300"],
    "respuesta": "500"
},
{
    "pregunta": "Mar칤a ten칤a 320 l치pices. Compr칩 150 m치s y perdi칩 50. 쮺u치ntos l치pices le quedan?",
    "opciones": ["300", "400", "350", "420"],
    "respuesta": "420"
},
{
    "pregunta": "Un agricultor ten칤a 500 manzanas. Vendi칩 200 y luego compr칩 150 m치s. 쮺u치ntas manzanas tiene ahora?",
    "opciones": ["400", "450", "300", "350"],
    "respuesta": "450"
},
{
    "pregunta": "Juan tiene 360 galletas. Le dio 120 a su amiga y compr칩 200 m치s. 쮺u치ntas galletas tiene ahora?",
    "opciones": ["420", "460", "440", "480"],
    "respuesta": "440"
},
{
    "pregunta": "Un caracol subi칩 30 metros cada d칤a durante 10 d칤as. 쮺u치ntos metros subi칩 en total?",
    "opciones": ["300", "400", "350", "500"],
    "respuesta": "300"
},
{
    "pregunta": "Sof칤a compr칩 120 entradas para el cine. Vendi칩 70 y luego compr칩 150 m치s. 쮺u치ntas entradas tiene ahora?",
    "opciones": ["220", "250", "300", "200"],
    "respuesta": "200"
},
{
    "pregunta": "En una escuela hay 450 alumnos. Se inscribieron 250 m치s y se dieron de baja 100. 쮺u치ntos alumnos hay ahora?",
    "opciones": ["500", "550", "600", "450"],
    "respuesta": "600"
},
{
    "pregunta": "Pedro ten칤a 600 monedas. Compr칩 200 m치s y gast칩 150. 쮺u치ntas monedas tiene ahora?",
    "opciones": ["700", "650", "550", "500"],
    "respuesta": "650"
},
{
    "pregunta": "Un jard칤n tiene 200 plantas. Plantaron 100 m치s y regalaron 50. 쮺u치ntas plantas quedan?",
    "opciones": ["250", "300", "270", "280"],
    "respuesta": "250"
},
{
    "pregunta": "Un paquete tiene 150 cajas. Cada caja contiene 20 productos. 쮺u치ntos productos hay en total?",
    "opciones": ["4000", "2500", "3000", "3500"],
    "respuesta": "3000"
},
{
    "pregunta": "En una biblioteca hay 400 libros. Se compraron 300 m치s y se vendieron 200. 쮺u치ntos libros hay ahora?",
    "opciones": ["600", "550", "450", "500"],
    "respuesta": "500"
},
{
    "pregunta": "Un tren tiene 50 vagones. Cada vag칩n tiene 30 pasajeros. 쮺u치ntos pasajeros viajan en total?",
    "opciones": ["1300", "1400", "1600", "1500"],
    "respuesta": "1500"
},
{
    "pregunta": "Pedro ten칤a 500 pesos. Compr칩 200 m치s y gast칩 150. 쮺u치ntos pesos tiene ahora?",
    "opciones": ["450", "550", "600", "500"],
    "respuesta": "550"
},
{
    "pregunta": "En una tienda hay 300 camisetas. Vendieron 150 y luego llegaron 100 m치s. 쮺u치ntas camisetas hay ahora?",
    "opciones": ["350", "300", "250", "400"],
    "respuesta": "250"
},
{
    "pregunta": "Un agricultor cultiv칩 80 hect치reas de ma칤z. En cada hect치rea cultiv칩 40 plantas. 쮺u치ntas plantas cultiv칩 en total?",
    "opciones": ["300", "3200", "3500", "4000"],
    "respuesta": "3200"
},
{
    "pregunta": "En una clase hay 150 estudiantes. Se inscribieron 200 m치s y luego salieron 50. 쮺u치ntos estudiantes hay ahora?",
    "opciones": ["200", "250", "300", "400"],
    "respuesta": "300"
},
{
    "pregunta": "En un supermercado hay 300 productos. Se compraron 400 m치s y se vendieron 150. 쮺u치ntos productos hay ahora?",
    "opciones": ["650", "550", "500", "600"],
    "respuesta": "550"
},
{
    "pregunta": "Jos칠 ten칤a 500 pesos. Ahorro 150 m치s y gast칩 100. 쮺u치ntos pesos tiene ahora?",
    "opciones": ["450", "500", "600", "550"],
    "respuesta": "550"
},
{
    "pregunta": "Un autob칰s transporta 40 personas. Si viajan en 12 autobuses, 쯖u치ntas personas viajan en total?",
    "opciones": ["400", "500", "480", "450"],
    "respuesta": "480"
},
{
    "pregunta": "Una f치brica produce 1200 piezas al d칤a. 쮺u치ntas piezas produce en 10 d칤as?",
    "opciones": ["11000", "12000", "13000", "14000"],
    "respuesta": "12000"
},
{
    "pregunta": "Un colegio tiene 300 estudiantes. Se inscribieron 400 m치s y luego se fueron 200. 쮺u치ntos estudiantes hay ahora?",
    "opciones": ["400", "450", "500", "600"],
    "respuesta": "500"
},
{
    "pregunta": "El gimnasio tiene 600 miembros. Se inscribieron 150 m치s y se dieron de baja 100. 쮺u치ntos miembros hay ahora?",
    "opciones": ["500", "700", "650", "600"],
    "respuesta": "650"
},
{
    "pregunta": "Juan tiene 150 estampillas. Compr칩 100 m치s y regal칩 50. 쮺u치ntas estampillas tiene ahora?",
    "opciones": ["200", "250", "300", "150"],
    "respuesta": "200"
},
{
    "pregunta": "En una tienda se vendieron 300 pares de zapatos. Luego llegaron 200 m치s y se vendieron otros 150. 쮺u치ntos zapatos vendieron en total?",
    "opciones": ["550", "600", "500", "650"],
    "respuesta": "650"
},
{
    "pregunta": "El edificio tiene 15 pisos. Cada piso tiene 10 apartamentos. 쮺u치ntos apartamentos hay en total?",
    "opciones": ["100", "150", "200", "120"],
    "respuesta": "150"
}

];

let selectedAnswers = [];
let currentProblemIndex = 0;
let problemCount = 5;

// Esta funci칩n genera los problemas
function generateProblems() {
    selectedAnswers = [];
    currentProblemIndex = 0;
    let problemHtml = '';
    
    // Mezclamos aleatoriamente los problemas
    shuffleArray(problems);

    // Seleccionamos el n칰mero adecuado de problemas (5 o 10)
    for (let i = 0; i < problemCount; i++) {
        const problem = problems[i];
        problemHtml += `
            <div class="problem">
                <p>${problem.pregunta}</p>
                ${problem.opciones.map((option, index) => `
                    <input type="radio" name="question-${i}" value="${option}" id="q${i}a${index}">
                    <label for="q${i}a${index}">${option}</label><br>
                `).join('')}
            </div>
        `;
    }
    document.getElementById('problems').innerHTML = problemHtml;
    document.getElementById('problem-count').style.display = 'none'; // Oculta los botones para seleccionar el n칰mero de problemas
    document.getElementById('generate-btn').style.display = 'none'; // Oculta el bot칩n "Generar problemas"
    document.getElementById('grade-btn').style.display = 'inline'; // Muestra el bot칩n "Calificar"
}

// Esta funci칩n verifica las respuestas y muestra los resultados
function gradeProblems() {
    let score = 0;
    let incorrectAnswers = []; // Array para almacenar las respuestas incorrectas

    for (let i = 0; i < problemCount; i++) {
        const selectedOption = document.querySelector(`input[name="question-${i}"]:checked`);
        if (selectedOption && selectedOption.value === problems[i].respuesta) {
            score++;
        } else {
            // Almacena las respuestas incorrectas
            incorrectAnswers.push({
                pregunta: problems[i].pregunta,
                respuestaCorrecta: problems[i].respuesta,
                respuestaUsuario: selectedOption ? selectedOption.value : "No respondida"
            });
        }
    }

    // Mostrar los resultados
    const resultElement = document.getElementById('result');
    if (score === problemCount) {
        resultElement.innerHTML = `<span class="congratulations">춰Felicidades! Obtuviste todas las respuestas correctas. 游끥</span>`;
    } else {
        resultElement.innerHTML = `<span class="error">Obtuviste ${score} de ${problemCount} correctas. Sigue practicando.</span>`;
    }

    // Mostrar las respuestas incorrectas
    if (incorrectAnswers.length > 0) {
        let incorrectHtml = '<h3>Problemas Incorrectos:</h3><ul>';
        incorrectAnswers.forEach(incorrect => {
            incorrectHtml += `
                <li>
                    <p><strong>Pregunta:</strong> ${incorrect.pregunta}</p>
                    <p><strong>Tu respuesta:</strong> ${incorrect.respuestaUsuario}</p>
                    <p><strong>Respuesta correcta:</strong> ${incorrect.respuestaCorrecta}</p>
                </li>
            `;
        });
        incorrectHtml += '</ul>';
        document.getElementById('incorrect-answers').innerHTML = incorrectHtml;
    }

    document.getElementById('back-btn').style.display = 'inline'; // Muestra el bot칩n "Regresar"
}

// Funci칩n para mezclar aleatoriamente los problemas
function shuffleArray(array) {
    for (let i = array.length - 1; i > 0; i--) {
        const j = Math.floor(Math.random() * (i + 1));
        [array[i], array[j]] = [array[j], array[i]]; // Intercambia los elementos
    }
}

// Eventos para los botones
document.getElementById('generate-btn').addEventListener('click', generateProblems);
document.getElementById('grade-btn').addEventListener('click', gradeProblems);
document.getElementById('back-btn').addEventListener('click', function () {
    document.getElementById('problem-count').style.display = 'block'; // Muestra los botones de selecci칩n nuevamente
    document.getElementById('generate-btn').style.display = 'none'; // Oculta el bot칩n "Generar" al regresar
    document.getElementById('back-btn').style.display = 'none'; // Oculta el bot칩n "Regresar" al regresar
    document.getElementById('grade-btn').style.display = 'none'; // Oculta el bot칩n "Calificar" al regresar
    document.getElementById('result').innerHTML = ''; // Limpia los resultados
    document.getElementById('incorrect-answers').innerHTML = ''; // Limpia las respuestas incorrectas
    document.getElementById('problems').innerHTML = ''; // Limpia los problemas
});

document.getElementById('five-problems').addEventListener('click', function() {
    problemCount = 5;
    generateProblems();
});

document.getElementById('ten-problems').addEventListener('click', function() {
    problemCount = 10;
    generateProblems();
});
